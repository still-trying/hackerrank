long largestRectangle(int h_count, int* h) {

int* stack = (int*)malloc(h_count * sizeof(int));
int top = -1;

long max_area = 0;
int i = 0;

while (i < h_count) {

if (top == -1 || h[stack[top]] <= h[i]) {
stack[++top] = i++;
} else {

int tp = stack[top--];


long area = (long)h[tp] * (top == -1 ? i : i - stack[top] - 1);

if (area > max_area) {
max_area = area;
}
}
}

while (top != -1) {
int tp = stack[top--];
long area = (long)h[tp] * (top == -1 ? i : i - stack[top] - 1);

if (area > max_area) {
max_area = area;
}
}

free(stack);
return max_area;


}
